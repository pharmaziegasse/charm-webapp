(this.webpackJsonpcharm=this.webpackJsonpcharm||[]).push([[0],{229:function(e,t,a){e.exports=a.p+"static/media/logo.58fe2d77.png"},232:function(e,t,a){e.exports=a(545)},240:function(e,t,a){},420:function(e,t,a){},511:function(e,t,a){},513:function(e,t,a){},530:function(e,t,a){},531:function(e,t,a){},533:function(e,t,a){},545:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(20),s=a.n(l),c=(a(237),a(36)),o=a(13),i=a(49),u=a(44),m=(a(238),a(239),a(240),a(19)),d=a.n(m),p=a(16),h=a(17),f=a(22),g=a(21),b=a(23),E=a(18),v=a(14),y=a(3),k=(a(420),function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).logout=function(){localStorage.removeItem("fprint"),window.location.href="/login"},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.globalState;return r.a.createElement(y.q,{color:"unique-darkblue",className:"mt-4"},void 0!==t.coach&&t.logged&&r.a.createElement("div",{className:"py-4"},r.a.createElement(y.m,null,t.coach?r.a.createElement(y.A,{className:"text-center flex-center"},r.a.createElement(y.j,{md:"4"},r.a.createElement("a",{href:"mailto:support@aichner-christian.com"},r.a.createElement("li",{className:"list-unstyled"},r.a.createElement(y.t,{icon:"medkit"}),"Support"))),r.a.createElement(y.j,{md:"4"},r.a.createElement("li",{className:"list-unstyled clickable",onClick:function(){return e.logout()}},r.a.createElement(y.t,{icon:"sign-out-alt"}),"Logout"))):r.a.createElement(y.A,{className:"text-center flex-center"},r.a.createElement(y.j,{md:"4"},r.a.createElement("a",{href:"#!"},"Referral Programm")),r.a.createElement(y.j,{md:"4"},r.a.createElement("a",{href:"#!"},r.a.createElement(y.t,{fab:!0,icon:"facebook-f",className:"pr-2"})),r.a.createElement("a",{href:"#!"},r.a.createElement(y.t,{fab:!0,icon:"instagram",className:"pl-2"}))),r.a.createElement(y.j,{md:"4"},r.a.createElement("a",{href:"#!"},"Fragen? Wir sind f\xfcr Sie da!"))))),r.a.createElement("div",{className:"footer-copyright text-center py-3"},r.a.createElement(y.m,{fluid:!0},r.a.createElement("div",null,"\xa9 2018 - ",(new Date).getFullYear()," Copyright: PHARMAZIEGASSE",r.a.createElement("sup",null,"\xae")),r.a.createElement("div",null,r.a.createElement("small",{className:"text-muted"},"Alpha release",r.a.createElement("span",{className:"pl-2 pr-2"},"\xb7"),"Version v","0.10.0",r.a.createElement("span",{className:"pl-2 pr-2"},"\xb7"),r.a.createElement("a",{href:"https://github.com/pharmaziegasse/charm-webapp",rel:"noopener noreferrer",target:"_blank"},r.a.createElement(y.t,{fab:!0,icon:"github",className:"pr-2"}),"View on GitHub"),r.a.createElement("span",{className:"pl-2 pr-2"},"\xb7"),r.a.createElement("a",{href:"https://github.com/pharmaziegasse/charm-webapp/issues/new?template=bug_report.md",rel:"noopener noreferrer",target:"_blank"},r.a.createElement(y.t,{icon:"bug",className:"pr-2"}),"Report bug"))))))}}]),t}(r.a.PureComponent)),N=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).handleResize=function(){return a.setState({windowWidth:window.innerWidth})},a.handleToggleClickA=function(){a.setState({toggleStateA:!a.state.toggleStateA})},a.state={toggleStateA:!1,breakWidth:1300,windowWidth:0},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.C,{triggerOpening:this.state.toggleStateA,breakWidth:this.state.breakWidth,fixed:!0},r.a.createElement(y.c,{className:"mx-5 mt-5 mb-3"},r.a.createElement("img",{src:"https://mdbootstrap.com/img/Photos/Avatars/img%20(20).jpg",alt:"",className:"rounded-circle img-fluid"})),r.a.createElement("h4",{className:"text-center"},"Erika Mustermann"),r.a.createElement("li",null,r.a.createElement("ul",{className:"social"},r.a.createElement("li",null,r.a.createElement("a",{href:"#!"},r.a.createElement(y.t,{fab:!0,icon:"facebook-f"}))),r.a.createElement("li",null,r.a.createElement("a",{href:"#!"},r.a.createElement(y.t,{fab:!0,icon:"pinterest"}))),r.a.createElement("li",null,r.a.createElement("a",{href:"#!"},r.a.createElement(y.t,{fab:!0,icon:"google-plus-g"}))),r.a.createElement("li",null,r.a.createElement("a",{href:"#!"},r.a.createElement(y.t,{fab:!0,icon:"twitter"}))))),r.a.createElement(y.F,null,r.a.createElement(y.D,{name:"Submit blog",id:"submit-blog-cat",icon:"chevron-right"},r.a.createElement(y.E,null,"Submit listing"),r.a.createElement(y.E,null,"Registration form")),r.a.createElement(y.D,{iconRegular:!0,name:"Instruction",id:"instruction-cat",icon:"hand-pointer"},r.a.createElement(y.E,null,"For bloggers"),r.a.createElement(y.E,null,"For authors")),r.a.createElement(y.D,{name:"About",id:"about-cat",icon:"eye"},r.a.createElement(y.E,null,"Instruction"),r.a.createElement(y.E,null,"Monthly meetings")),r.a.createElement(y.D,{name:"Contact me",id:"contact-me-cat",icon:"envelope"},r.a.createElement(y.E,null,"FAQ"),r.a.createElement(y.E,null,"Write a message"))),r.a.createElement(y.E,{className:"nav-settings"},r.a.createElement(y.t,{icon:"cog",className:"pr-2"}),"Einstellungen")))}}]),t}(r.a.Component),S=(a(4),a(60)),x=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&window.scrollTo(0,0)}},{key:"render",value:function(){return this.props.children}}]),t}(r.a.Component),O=Object(S.g)(x),j=a(224),w=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={dataRadar:{labels:["Gro\xdfe Poren","Sensible Haut","Hautalterung","\xd6lige Haut","Trockene Haut","Unreine Haut","Pigmentflecken","Zeichen\noxidativen Stresses"],datasets:[{label:"# of Votes",data:[10,7,10,10,4,10,2,5],backgroundColor:["rgba(150, 0, 150, 0.2)"],borderColor:["rgba(150, 0, 150, 1)"],borderWidth:1}]},dataRadarOptions:{responsive:!0,elements:{line:{tension:.4}},legend:{display:!1},scale:{ticks:{beginAtZero:!0,max:10,min:0}},scales:{yAxes:[{gridLines:{display:!1,drawBorder:!1},ticks:{display:!1}}],xAxes:[{gridLines:{display:!1,drawBorder:!1},ticks:{beginAtZero:!0,display:!1,stepSize:1,min:0,max:10}}]}},dataRadarPlugins:[{beforeInit:function(e){e.data.labels.forEach((function(e,t,a){/\n/.test(e)&&(a[t]=e.split(/\n/))}))}}]},a.componentDidMount=function(){document.title="Dein individuelles Programm"},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.globalState;return e.logged?e.loaded&&void 0!==e.coach?e.logged&&e.coach?r.a.createElement(S.a,{to:"/coach"}):r.a.createElement(n.Fragment,null,r.a.createElement(N,null),r.a.createElement("div",{className:"support-card"},r.a.createElement(y.e,{tag:"a",size:"lg",floating:!0,gradient:"night-fade"},r.a.createElement(y.t,{far:!0,icon:"comments fa-2x"})),r.a.createElement(y.e,{rounded:!0,outline:!0,color:"secondary"},"Coach kontaktieren")),r.a.createElement(y.m,null,r.a.createElement(y.A,{className:"justify-content-center"},r.a.createElement(y.j,{md:"6"},r.a.createElement(y.f,{className:"chart-card"},r.a.createElement(y.g,null,r.a.createElement(y.i,{className:"mb-4"},"Ihr Hautzustand"),r.a.createElement(j.a,{data:this.state.dataRadar,options:this.state.dataRadarOptions,plugins:this.state.dataRadarPlugins}),r.a.createElement(y.h,{className:"mt-4"},"Some quick example text to build on the card title and make up the bulk of the card's content.")))),r.a.createElement(y.j,{md:"6"},r.a.createElement(y.f,{className:"timeline-card"},r.a.createElement(y.g,{className:"py-0"},r.a.createElement(y.A,null,r.a.createElement("div",{className:"mdb-feed"},r.a.createElement("div",{className:"news"},r.a.createElement("div",{className:"label"},r.a.createElement("img",{src:"https://mdbootstrap.com/img/Photos/Avatars/img%20(18)-mini.jpg",alt:"",className:"rounded-circle z-depth-1-half"})),r.a.createElement("div",{className:"excerpt"},r.a.createElement("div",{className:"brief"},r.a.createElement("a",{href:"#!",className:"name"},"Monika")," hat Ihr neues Programm ",r.a.createElement("a",{href:"#!"},"versendet"),r.a.createElement("div",{className:"date"},"Vor 10 Stunden")),r.a.createElement("div",{className:"added-images"},r.a.createElement("img",{src:"https://pharmaziegasse.at/media/images/IMG_9948.original.jpg",alt:"",className:"z-depth-1 rounded mb-md-0 mb-2"})))),r.a.createElement("div",{className:"news"},r.a.createElement("div",{className:"label"},r.a.createElement("img",{src:"https://mdbootstrap.com/img/Photos/Avatars/img%20(20)-mini.jpg",alt:"",className:"rounded-circle z-depth-1-half"})),r.a.createElement("div",{className:"excerpt"},r.a.createElement("div",{className:"brief"},"Sie haben sich die Verbesserungen angesehen",r.a.createElement("div",{href:"#!",className:"date"},"Vor 14 Stunden")))),r.a.createElement("div",{className:"news"},r.a.createElement("div",{className:"label"},r.a.createElement("img",{src:"https://mdbootstrap.com/img/Photos/Avatars/img%20(18)-mini.jpg",alt:"",className:"rounded-circle z-depth-1-half"})),r.a.createElement("div",{className:"excerpt"},r.a.createElement("div",{className:"brief"},r.a.createElement("a",{href:"#!",className:"name"},"Monika")," hat Ihr Programm verbessert",r.a.createElement("div",{className:"date"},"Vor 2 Tagen")),r.a.createElement("div",{className:"added-text"},"Da Ihre unreine Haut am meisten Potential f\xfcr Verbesserungen bietet, habe ich Ihr individuelles Programm genau auf Ihre Bed\xfcrfnisse hin angepasst."))),r.a.createElement("div",{className:"news"},r.a.createElement("div",{className:"label"},r.a.createElement("img",{src:"https://mdbootstrap.com/img/Photos/Avatars/img%20(20)-mini.jpg",alt:"",className:"rounded-circle z-depth-1-half"})),r.a.createElement("div",{className:"excerpt"},r.a.createElement("div",{className:"brief"},"Sie haben Ihren ",r.a.createElement("a",{href:"#!"},"Hautzustand")," aktualisiert",r.a.createElement("div",{className:"date"},"Vor 3 Tagen")),r.a.createElement("div",{className:"added-images"},r.a.createElement("img",{src:"https://pixnio.com/free-images/2017/11/30/2017-11-30-18-11-20-1200x800.jpg",alt:"",className:"z-depth-1 rounded"})))),r.a.createElement("a",{href:"!#"},"Gesamte Timeline anzeigen")))))),r.a.createElement(y.j,{md:"10",className:"my-5"},r.a.createElement(y.f,{className:"coach-card"},r.a.createElement(y.g,null,r.a.createElement(y.A,null,r.a.createElement(y.j,{md:"auto pl-5"},r.a.createElement(y.c,null,r.a.createElement("img",{src:"https://mdbootstrap.com/img/Photos/Avatars/img%20(18).jpg",alt:"",className:"rounded-circle img-fluid"}))),r.a.createElement(y.j,{className:"align-self-center"},r.a.createElement("h4",null,"Monika Mustermann"),r.a.createElement("p",{className:"text-muted m-0"},"Ihr pers\xf6licher Beauty Coach")),r.a.createElement(y.j,{className:"align-self-center text-right pr-5"},r.a.createElement(y.e,{rounded:!0,outline:!0,color:"secondary"},"Coach kontaktieren"))))))))):r.a.createElement("div",{className:"w-100 h-100 flex-center"},r.a.createElement(y.G,null)):r.a.createElement(S.a,{to:"/login"})}}]),t}(r.a.Component),_=a(9),C=a(102),I=a.n(C),T={display:["INLINE_STYLE_BUTTONS","BLOCK_TYPE_BUTTONS","LINK_BUTTONS","BLOCK_TYPE_DROPDOWN","HISTORY_BUTTONS"],INLINE_STYLE_BUTTONS:[{label:"Bold",style:"BOLD",className:"custom-css-class"},{label:"Italic",style:"ITALIC"},{label:"Underline",style:"UNDERLINE"}],BLOCK_TYPE_DROPDOWN:[{label:"Normal",style:"unstyled"},{label:"Heading Large",style:"header-one"},{label:"Heading Medium",style:"header-two"},{label:"Heading Small",style:"header-three"}],BLOCK_TYPE_BUTTONS:[{label:"UL",style:"unordered-list-item"},{label:"OL",style:"ordered-list-item"}]},A=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).componentWillMount=function(){Object.keys(a.props.location.state.articles).map((function(e,t){return a.setState(Object(_.a)({},"collapse"+t,!0)),""!==a.props.location.state.articles[e].text&&void 0!==a.props.location.state.articles[e].text?(a.setState(Object(_.a)({},"value"+t,I.a.createValueFromString(a.props.location.state.articles[e].text,"html"))),!0):(a.setState(Object(_.a)({},"value"+t,I.a.createEmptyValue())),!1)})),document.title="Beautyreport Revision"},a.toggleCollapse=function(e){return function(){return a.setState(Object(_.a)({},e,!a.state[e]))}},a.getStatus=function(){var e=0;Object.keys(a.state).map((function(t,n){return!1===a.state[t]&&e++,!0}));var t=Object.keys(a.props.location.state.articles).length;return e/t*100},a.isFinished=function(){return 100!==a.getStatus()},a.onChange=function(e,t){a.setState(Object(_.a)({},"value"+e,t))},a.goBack=function(){a.props.history.push("../report")},a.state={test:""},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.globalState;if(!t.logged)return r.a.createElement(S.a,{to:"/login"});if(t.logged&&!t.coach)return r.a.createElement(S.a,{to:"/dashboard"});console.log(this.state);var a=this.props.location;return void 0!==a?void 0!==a.state?r.a.createElement(y.m,{className:"pt-5"},r.a.createElement("h2",{className:"text-center font-weight-bold"},"Beautyreport \xfcberpr\xfcfen"),r.a.createElement("div",{className:"mt-4 mb-3 text-left"},r.a.createElement(v.b,{to:"/report"},r.a.createElement(y.e,{color:"red"},r.a.createElement(y.t,{icon:"angle-left",className:"pr-2"}),"Zur\xfcck"))),r.a.createElement(y.z,{material:!0,color:100===this.getStatus()?"success":"secondary",value:this.getStatus(),height:"20px"},this.getStatus()>0&&r.a.createElement(r.a.Fragment,null,Math.round(this.getStatus()),"% abgeschlossen")),Object.keys(a.state.articles).map((function(t,n){var l=a.state.articles[t];return r.a.createElement(y.f,{key:n,className:"mt-3"},r.a.createElement(y.l,null,r.a.createElement(y.A,{className:"justify-content-center"},r.a.createElement(y.j,{md:"6",className:"align-self-center section-title"},l.heading),r.a.createElement(y.j,{md:"6",className:"text-right"},r.a.createElement(y.v,{label:"\xdcberpr\xfcft",filled:!0,type:"checkbox",id:"checkbox"+n,onClick:e.toggleCollapse("collapse"+n)})))),r.a.createElement(y.k,{id:"collapse1",isOpen:e.state["collapse"+n]},r.a.createElement(y.g,null,r.a.createElement(I.a,{value:e.state["value"+n],className:"textfield",onChange:function(t){return e.onChange(n,t)},readOnly:!e.state["collapse"+n],toolbarConfig:T}))))})),r.a.createElement(y.A,{className:"my-4"},r.a.createElement(y.j,{md:"6",className:"text-left"},r.a.createElement(y.e,{color:"danger",onClick:this.goBack},r.a.createElement(y.t,{icon:"times",className:"pr-2"}),"Verwerfen")),r.a.createElement(y.j,{md:"6",className:"text-right"},r.a.createElement(y.e,{color:"success",disabled:this.isFinished()},r.a.createElement(y.t,{icon:"save",className:"pr-2"}),"Speichern"),r.a.createElement(y.e,{color:"green",disabled:this.isFinished()},r.a.createElement(y.t,{far:!0,icon:"file-pdf",className:"pr-2"}),"Speichern + PDF")))):null:r.a.createElement(S.a,{to:"/login"})}}]),t}(r.a.Component),P=a(32),B=a(552),F=a(33),D=a.n(F);a(511);function L(){var e=Object(E.a)(["\n    query getBeautyReports_byUid($token: String!, $id: Int!) {\n        brByUid(token: $token, uid: $id) {\n            __typename\n            id\n            date\n            document{\n                __typename\n                id\n                link\n            }\n        }\n        brLatestByUid(token: $token, uid: $id) {\n            __typename\n            id\n            date\n            user{\n                firstName\n                lastName\n                customerId\n            }\n            document{\n                __typename\n                id\n                link\n            }\n        }\n    }\n"]);return L=function(){return e},e}var $=D()(L()),R=new c.a({link:new i.a({uri:"https://manage.pharmaziegasse.at/api/graphql"}),cache:new u.a,defaultOptions:{query:{fetchPolicy:"network-only",errorPolicy:"all"}}}),q=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).componentDidMount=function(){document.title="Beautyreport List",a.props.match&&a.props.match.params&&a.props.match.params.uid&&a.setState({uid:a.props.match.params.uid,loading:!0},(function(){return a.fetchReports(a.props.match.params.uid)}))},a.fetchReports=function(e){a.fetchAllReports(e)},a.fetchAllReports=function(e){R.query({query:$,variables:{id:e,token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;t.brLatestByUid&&(console.log("Data"),console.log(t),a.setState({user:t.brLatestByUid.user,reports:Object(P.a)({},a.state.reports,{latest:t.brLatestByUid}),exists:!0,loading:!1})),t.brByUid?(console.log("Beautyreports exist for this user"),a.setState({reports:Object(P.a)({},a.state.reports,{legacy:t.brByUid}),exists:!0,loading:!1})):console.log("There are no Beautyreports for this user"),null===t.brLatestByUid&&a.setState({exists:!1})})).catch((function(e){a.setState({reports:{legacy:[],latest:void 0},loading:!1},(function(){return console.error("Error",e)}))}))},a.getDate=function(e){var t=new Date(e),a=t.getFullYear(),n=("0"+(t.getMonth()+1)).slice(-2);return("0"+t.getDate()).slice(-2)+"."+n+"."+a+" "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},a._getTable=function(){return{columns:[{label:"#",field:"id",sort:"desc"},{label:"Date",field:"date",sort:"asc"},{label:"Visible",field:"visible",sort:"disabled"},{label:"PDF Upload",field:"pdf",sort:"disabled"},{label:"Download",field:"download",sort:"disabled"},{label:"Quick actions",field:"actions",sort:"disabled"}],rows:a._getBeautyReports()}},a._getBeautyReports=function(){return a.state.reports.legacy.map((function(e,t){return{id:t+1,date:a.getDate(e.date),visible:r.a.createElement(y.v,{label:"F\xfcr Kunden sichtbar",filled:!0,type:"checkbox",disabled:!0,id:"show_latest_"+t}),pdf:r.a.createElement(y.p,{btnTitle:"File ausw\xe4hlen",btnColor:"purple",textFieldTitle:"Lade das PDF hoch"}),download:r.a.createElement(r.a.Fragment,null,null!==e.document?r.a.createElement("a",{href:"https://manage.pharmaziegasse.at/"+e.document.link},r.a.createElement(y.e,{size:"md",color:"primary"},r.a.createElement(y.t,{icon:"file-word",className:"pr-2"}),"Download")):r.a.createElement("p",null,"No download")),actions:r.a.createElement(y.e,{size:"md",color:"danger",disabled:!0},r.a.createElement(y.t,{icon:"trashcan",className:"pr-2"}),"Remove")}}))},a.state={userId:void 0,reports:{latest:void 0,legacy:[]},showLegacy:!1},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.globalState;t.match;return a.logged?a.logged&&!a.coach?r.a.createElement(S.a,{to:"/dashboard"}):!1===this.state.uid||!1===this.state.exists?r.a.createElement(S.a,{to:"/coach"}):(console.log(this.state),r.a.createElement(y.m,{className:"text-center pt-5",id:"reportlist"},this.state.user?r.a.createElement("h2",{className:"text-center font-weight-bold"},"Beauty reports of ",this.state.user.firstName+" "+this.state.user.lastName):r.a.createElement("p",null,"Loading.."),r.a.createElement("div",{className:"mt-4"},r.a.createElement(y.A,null,r.a.createElement(y.j,{md:"6",className:"text-left"},r.a.createElement(v.b,{to:"/coach"},r.a.createElement(y.e,{color:"red"},r.a.createElement(y.t,{icon:"angle-left",className:"pr-2"}),"Dashboard"))),r.a.createElement(y.j,{md:"6",className:"text-right"},r.a.createElement(v.b,{to:{pathname:"/create/"+this.state.uid}},r.a.createElement(y.e,{color:"green"},r.a.createElement(y.t,{fa:!0,icon:"signature",className:"pr-2"}),"Create Beautyreport"))))),this.state.loading?r.a.createElement("div",{className:"text-center w-100 h-100"},r.a.createElement(y.G,null)):r.a.createElement("div",{className:"mt-4"},r.a.createElement(y.A,{className:"flex-center mb-4"},r.a.createElement(y.j,{md:"6"},r.a.createElement(y.f,null,this.state.reports.latest?r.a.createElement(y.g,{className:"active-report"},r.a.createElement("p",{className:"lead font-weight-bold"},"Latest beautyreport"),r.a.createElement("small",null,this.getDate(this.state.reports.latest.date)),r.a.createElement("p",{className:"lead mt-3 mb-2"},"Download"),this.state.reports.latest.document&&r.a.createElement("a",{href:"https://manage.pharmaziegasse.at/"+this.state.reports.latest.document.link,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(y.e,{color:"primary",className:"d-block m-auto"},r.a.createElement(y.t,{icon:"file-word",className:"pr-2"}),"MS Word")),r.a.createElement("hr",null),r.a.createElement("p",{className:"lead my-3"},"Upload latest version"),r.a.createElement(y.p,{btnTitle:"File ausw\xe4hlen",btnColor:"purple",textFieldTitle:"Lade das neueste PDF hoch"}),r.a.createElement("p",{className:"lead mt-3"},"Current report"),r.a.createElement("small",null,"Uploaded: 19.09.2019 12:42:22"),r.a.createElement(y.e,{color:"red",disabled:!0,className:"d-block mt-3 ml-auto mr-auto"},r.a.createElement(y.t,{icon:"file-pdf",className:"pr-2"}),"PDF anzeigen"),r.a.createElement(y.v,{disabled:!0,label:"Visible for customers",filled:!0,type:"checkbox",id:"show_latest"})):null))),this.state.reports.legacy.length>=1?r.a.createElement(r.a.Fragment,null,this.state.showLegacy?r.a.createElement(y.n,{striped:!0,bordered:!0,small:!0,exportToCSV:!0,data:this._getTable(),paginationLabel:[r.a.createElement(y.t,{icon:"angle-left",size:"lg",className:"pl-3 pr-3"}),r.a.createElement(y.t,{icon:"angle-right",size:"lg",className:"pl-3 pr-3"})]}):r.a.createElement("span",{onClick:function(){e.setState({showLegacy:!0})},className:"blue-text clickable"},"Show older versions")):r.a.createElement("h3",null,"No beautyreports yet.")))):r.a.createElement(S.a,{to:"/login"})}}]),t}(r.a.Component),U=Object(B.b)(q),z=a(101);function G(e,t){var a,n,r,l,s;return d.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(!e||!t){c.next=22;break}return e=e.trim(),t=t.trim(),a="https://api.opencagedata.com/geocode/v1/json?q=".concat(e,"\n&key=").concat("2789e058c68d428b88d377f3a837e474","\n&language=en"),c.next=6,d.a.awrap(fetch(a));case 6:if(!(n=c.sent).ok){c.next=19;break}return c.next=10,d.a.awrap(n.json());case 10:if(!(r=c.sent)){c.next=17;break}if(!r.results){c.next=17;break}return l=r.results,s=void 0,l.map((function(e,a){console.log(e),e.components["ISO_3166-1_alpha-2"]===t&&(s?e.confidence>s.confidence&&(s={status:n.status,confidence:e.confidence,lat:e.geometry.lat,lng:e.geometry.lng}):s={status:n.status,confidence:e.confidence,lat:e.geometry.lat,lng:e.geometry.lng})})),c.abrupt("return",s);case 17:c.next=20;break;case 19:return c.abrupt("return",{status:n.status});case 20:c.next=23;break;case 22:return c.abrupt("return",{status:400});case 23:case"end":return c.stop()}}))}function M(e,t){var a,n,r,l,s,c;return d.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!e||!t){o.next=20;break}return a=new Date((new Date).setFullYear((new Date).getFullYear()-1)),n=Math.round(a/1e3),r="https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/\n".concat("5aafae64856e7b0073b41e4eed5b7f9b","/\n").concat(e,",").concat(t,",\n").concat(n,"?exclude=currently,flags,hourly,alerts"),o.next=6,d.a.awrap(fetch(r));case 6:if(!(l=o.sent).ok){o.next=17;break}return o.next=10,d.a.awrap(l.json());case 10:if(!(s=o.sent)){o.next=15;break}if(!s.daily){o.next=15;break}return c=s.daily.data[0],o.abrupt("return",{status:200,avgTemp:5/9*((c.temperatureHigh+c.temperatureLow)/2-32),uvIndex:c.uvIndex,humidity:c.humidity});case 15:o.next=18;break;case 17:return o.abrupt("return",{status:l.status});case 18:o.next=21;break;case 20:return o.abrupt("return",{status:400});case 21:case"end":return o.stop()}}))}a(513);function V(){var e=Object(E.a)(["\n    query getAnamneseData_byUid($token: String!, $id: Int!) {\n        anLatestByUid(token: $token, uid: $id) {\n            id\n            date\n            formData\n            user {\n                id\n                username\n            }\n            document{\n                id\n                link\n            }\n        }\n    }\n"]);return V=function(){return e},e}function H(){var e=Object(E.a)(["\n    query getBasicData($token: String!, $id: Int!) {\n        userById(token: $token, id: $id) {\n            id\n            firstName\n            lastName\n            username\n            city\n            country\n        }\n    }\n"]);return H=function(){return e},e}function W(){var e=Object(E.a)(["\n    mutation createAn ($token: String!, $values: GenericScalar!, $urlpath: String!) {\n        anamneseAnFormPage(\n            token: $token,\n            url: $urlpath,\n            values: $values\n        ) {\n            result\n            errors {\n                name\n                errors\n            }\n        }\n    }\n"]);return W=function(){return e},e}function Q(){var e=Object(E.a)(["\n    query getAnamneseFields($token: String!) {\n        pages (token: $token) {\n            ... on AnamneseAnFormPage {\n                urlPath\n                formFields {\n                    name\n                    fieldType\n                    helpText\n                    required\n                    choices\n                    defaultValue\n                    label\n                }\n            }\n        }\n    }\n"]);return Q=function(){return e},e}var K=D()(Q()),J=D()(W()),Y=D()(H()),Z=D()(V()),X=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).componentDidMount=function(){document.title="Anamnese",console.log(a.props),a.props.match&&a.props.match.params&&a.props.match.params.uid&&a.setState({uid:a.props.match.params.uid},(function(){return a.initialize()}))},a.initialize=function(){return d.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a.getAnamneseFields();case 1:case"end":return e.stop()}}))},a.__init=function(){a.getBasicUserData()},a.__initExternal=function(e){e.city&&e.country&&a.__getCityLatLng(e.city,e.country)},a.__getCityLatLng=function(e,t){var n;return d.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log(e,t),r.next=3,d.a.awrap(G(e,t));case 3:(n=r.sent)&&(console.log("Result",n),200===n.status&&n.lat&&n.lng&&(console.log("Get weather data"),a.__getWeatherData(n.lat,n.lng)));case 5:case"end":return r.stop()}}))},a.__getWeatherData=function(e,t){var n;return d.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log(e,t),r.next=3,d.a.awrap(M(e,t));case 3:n=r.sent,console.log(n),a.setState({weatherAPI:n});case 6:case"end":return r.stop()}}))},a.resetButton=function(){a.state.success&&a.setState({success:!1})},a.getBasicUserData=function(){a.props.client.query({query:Y,variables:{token:localStorage.getItem("fprint"),id:a.state.uid}}).then((function(e){var t=e.data;console.log(t),a.setState({user:t.userById},(function(){return a.__initExternal(t.userById)}))})).catch((function(e){a.setState({user:!1},(function(){return console.error(e)}))}))},a.getAnamneseFields=function(){a.props.client.query({query:K,variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;a.setState({data:t},(function(){return a.getAnmaneseData()}))})).catch((function(e){a.setState({data:!1},(function(){return console.error(e)}))}))},a.getAnmaneseData=function(){console.log("called"),a.props.client.query({query:Z,variables:{token:localStorage.getItem("fprint"),id:a.state.uid}}).then((function(e){var t=e.data;console.log("Get anamnesis data"),console.log(t);var n=void 0;if(t.anLatestByUid.document&&t.anLatestByUid.document.link&&(n="https://manage.pharmaziegasse.at/"+t.anLatestByUid.document.link),t.anLatestByUid){var r=JSON.parse(t.anLatestByUid.formData),l={};console.log(r),void 0===r.uid.value?Object.keys(r).map((function(e,t){return l=Object(P.a)({},l,Object(_.a)({},e,null!==r[e]?r[e]:void 0)),t})):Object.keys(r).map((function(e,t){return l=Object(P.a)({},l,Object(_.a)({},e,null!==r[e]?r[e].value:void 0)),t})),a.setState(Object(P.a)({},a.state,{},l,{documentLink:n}),(function(){return a.__init()}))}})).catch((function(e){console.log(e),a.setState({formdata:!1},(function(){return a.__init()}))}))},a.sendData=function(){var e;return d.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e={},a.state.data.pages.map((function(t,n){"AnamneseAnFormPage"===t.__typename&&t.formFields.map((function(t,n){a.state[t.name]?e[t.name]=JSON.stringify({helpText:t.helpText,fieldType:t.fieldType,value:a.state[t.name]}):e[t.name]=JSON.stringify({helpText:t.helpText,fieldType:"",value:""})}))})),console.log(e),null===e||void 0===e||void 0===a.state.urlPath){t.next=6;break}return t.next=6,d.a.awrap(a.props.update({variables:{token:localStorage.getItem("fprint"),values:e,urlpath:a.state.urlPath}}).then((function(e){var t=e.data;if(console.log(t),t&&t.anamneseAnFormPage){var n=t.anamneseAnFormPage;"OK, parsed special input"===n.result||"OK"===n.result?(a.setState({success:!0,errors:[]}),[].forEach.call(document.querySelectorAll(".alert-error"),(function(e){e.parentNode.removeChild(e)}))):"FAIL"===n.result&&(console.log("Error"),a.setState({success:!1},(function(){return a.handleError(n.errors)})))}})).catch((function(e){console.error("Mutation error:",e)})));case 6:case"end":return t.stop()}}))},a.handleError=function(e){a.state.refNames.map((function(e,t){var n=a["".concat(e,"_ref")].current,r=n.querySelector(".alert");return null!==r&&n.removeChild(r),!0})),void 0!==e&&e.length>=1&&(a["".concat(e[0].name,"_ref")].current.scrollIntoView(),e.map((function(e,t){if("FormError"===e.__typename){var n=a["".concat(e.name,"_ref")].current,r=document.createElement("div");r.className="alert alert-danger alert-error mt-2",r.innerHTML='<i class="fa fa-angle-up pr-2"></i>'.concat(e.errors[0]),n.appendChild(r)}return!0})))},a._handleChange=function(e){a.setState(Object(_.a)({},e.target.name,e.target.value),(function(){return a.resetButton()}))},a._handleCheckBoxChange=function(e){a.setState(Object(_.a)({},e.target.name,e.target.checked),(function(){return a.resetButton()}))},a._handleCheckBoxesChange=function(e,t,n){var r=a.state[t];if(void 0!==r)if(r.includes(n)){var l=r.filter((function(e){return e!=n}));a.setState(Object(_.a)({},t,l),(function(){return a.resetButton()}))}else r.push(n),a.setState(Object(_.a)({},t,r),(function(){return a.resetButton()}));else{var s=[n];a.setState(Object(_.a)({},t,s),(function(){return a.resetButton()}))}},a._handleSelectChange=function(e){a.setState(Object(_.a)({},e.target.name,e.target.value),(function(){return a.resetButton()}))},a._setDefaultValue=function(e,t){if(""!==e.defaultValue&&void 0!==e.defaultValue&&(void 0===a.state[e.fieldType]||""===a.state[e.fieldType]||null===a.state[e.fieldType]))switch(e.fieldType){case"multiselect":var n=[];n=e.defaultValue.includes(", ")?e.defaultValue.split(", "):[e.defaultValue],a.state[e.name]||a.setState(Object(_.a)({},e.name,n));break;case"checkboxes":var r=[];r=e.defaultValue.includes(", ")?e.defaultValue.split(", "):[e.defaultValue],null!==a.state[e.name]&&void 0!==a.state[e.name]||a.setState(Object(_.a)({},e.name,r));break;case"checkbox":a.state[e.name]||(e.defaultValue?a.setState(Object(_.a)({},e.name,!0)):a.setState(Object(_.a)({},e.name,!1)));break;default:a.state[e.name]||a.setState(Object(_.a)({},e.name,e.defaultValue))}},a.getSelectValues=function(e){for(var t,a=[],n=e&&e.options,r=0,l=n.length;r<l;r++)(t=n[r]).selected&&a.push(t.value||t.text);return a},a._handleMultiSelectChange=function(e){a.setState(Object(_.a)({},e.target.name,a.getSelectValues(e.target)),(function(){return a.resetButton()}))},a._handleNumberClick=function(e,t){a.state[e]?a.setState(Object(_.a)({},e,parseInt(a.state[e],10)+parseInt(t,10)),(function(){return a.resetButton()})):a.setState(Object(_.a)({},e,0+parseInt(t,10)),(function(){return a.resetButton()}))},a.printCheckboxes=function(e,t){return e.choices.split(",").map((function(n,l){var s=n.trim().toLowerCase().replace(/ /g,""),c=n.trim();return r.a.createElement(y.v,{key:l,checked:!(!a.state[e.name]||!a.state[e.name].includes(c)),name:s,onChange:function(t){return a._handleCheckBoxesChange(t,e.name,c)},label:c,filled:!0,type:"checkbox",id:"fromGroupInput"+t+l})}))},a.printRadio=function(e,t,n,l){return e.split(",").map((function(e,s){var c=e.trim().toLowerCase().replace(/ /g,""),o=e.trim();return r.a.createElement(y.v,{onClick:function(){return a.setState(Object(_.a)({},t,o),(function(){return a.resetButton()}))},checked:!(!a.state[t]||a.state[t]!==o),label:o,key:s,name:c,type:"radio",id:"radio"+l+s,required:n})}))},a.printOptions=function(e,t){return e.split(",").map((function(e,t){var a=e.trim();return r.a.createElement("option",{key:t,value:a},a)}))},a.renderFields=function(){var e=a.state.data;if(void 0===e)return console.log("Loading"),r.a.createElement("div",{className:"text-center"},r.a.createElement(y.G,null));if(!1===e)return r.a.createElement("div",null,"Error!");if(void 0!==e){if(void 0!==e.pages){var t=void 0;return e.pages.map((function(e,a){return"AnamneseAnFormPage"===e.__typename&&(t=a),!0})),void 0!==t?(void 0===a.state.urlPath&&a.setState({urlPath:e.pages[t].urlPath}),e.pages[t].formFields.map((function(e,t){switch(a["".concat(e.name,"_ref")]=r.a.createRef(),a.state.refNames.includes(e.name)||a.setState((function(t){return{refNames:[].concat(Object(z.a)(t.refNames),[e.name])}})),a._setDefaultValue(e,t),e.fieldType.toLowerCase()){case"singleline":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("input",{type:"text",value:a.state[e.name],onChange:a._handleChange,name:e.name,className:"form-control",id:"fromGroupInput"+t,required:e.required}));case"hidden":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group my-3 d-none"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("input",{type:"text",value:a.state[e.name],name:e.name,className:"form-control",id:"fromGroupInput"+t,disabled:!0}));case"number":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("div",{className:"\r def-number-input\r number-input\r mb-3"},r.a.createElement("button",{onClick:function(){return a._handleNumberClick(e.name,-1)},className:"minus"}),r.a.createElement("input",{name:e.name,id:"fromGroupInput"+t,value:a.state[e.name],onChange:a._handleChange,type:"number"}),r.a.createElement("button",{onClick:function(){return a._handleNumberClick(e.name,1)},className:"plus"})));case"checkbox":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement(y.v,{checked:a.state[e.name],name:e.name,onChange:a._handleCheckBoxChange,label:e.label&&e.label,filled:!0,type:"checkbox",id:"fromGroupInput"+t}));case"checkboxes":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement(y.r,null,a.printCheckboxes(e,t)));case"dropdown":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("div",null,r.a.createElement("select",{name:e.name,selected:a.state[e.name],onChange:a._handleSelectChange,className:"browser-default custom-select"},r.a.createElement("option",null,"Choose your option"),a.printOptions(e.choices,t))));case"multiselect":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("div",null,r.a.createElement("select",{multiple:!0,name:e.name,selected:a.state[e.name],onChange:a._handleMultiSelectChange,className:"browser-default custom-select"},r.a.createElement("option",null,"Choose your option"),a.printOptions(e.choices,t))));case"radio":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),"temperatur"===e.name&&r.a.createElement(r.a.Fragment,null,a.state.weatherAPI&&200===a.state.weatherAPI.status&&r.a.createElement("span",{className:"text-muted"},"Durchschnittstemperatur am Kundenstandort: ",a.state.weatherAPI.avgTemp.toFixed(2)," \xb0C",r.a.createElement("br",null),r.a.createElement("small",null,"Powered by Dark Sky"))),"luftfeuchtigkeit"===e.name&&r.a.createElement(r.a.Fragment,null,a.state.weatherAPI&&200===a.state.weatherAPI.status&&r.a.createElement("span",{className:"text-muted"},"Absolute Luftfeuchtigkeit am Kundenstandort: ",a.state.weatherAPI.humidity.toFixed(2)," g/m",r.a.createElement("sup",null,"3"),r.a.createElement("br",null),r.a.createElement("small",null,"Powered by Dark Sky"))),"uv-index"===e.name&&r.a.createElement(r.a.Fragment,null,a.state.weatherAPI&&200===a.state.weatherAPI.status&&r.a.createElement("span",{className:"text-muted"},"UV Index am Kundenstandort: ",a.state.weatherAPI.uvIndex,r.a.createElement("br",null),r.a.createElement("small",null,"Powered by Dark Sky"))),r.a.createElement(y.r,null,a.printRadio(e.choices,e.name,e.required,t)));case"multiline":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("textarea",{className:"form-control",value:a.state[e.name],onChange:a._handleChange,name:e.name,id:"fromGroupInput"+t,rows:"5",required:e.required}));default:return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("input",{type:"text",value:a.state[e.name],onChange:a._handleChange,name:e.name,className:"form-control",id:"fromGroupInput"+t,required:e.required}))}}))):null}return null}return null},a.state={urlPath:void 0,errors:[],refNames:[],data:void 0,user:void 0,success:!1},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.globalState;return e.logged?e.logged&&!e.coach?r.a.createElement(S.a,{to:"/dashboard"}):(console.log(this.state),this.state.user?r.a.createElement(y.m,{id:"anamnesis",className:"text-left pt-5"},r.a.createElement("h2",{className:"mb-5 text-center"},"Anamnese f\xfcr"," ",this.state.user.firstName+" "+this.state.user.lastName),r.a.createElement(y.A,{className:"mt-4"},r.a.createElement(y.j,{md:"6",className:"text-left"},r.a.createElement(v.b,{to:"/coach"},r.a.createElement(y.e,{color:"red"},r.a.createElement(y.t,{icon:"angle-left",className:"pr-2"}),"Dashboard")),this.state.success?r.a.createElement(y.e,{color:"success",disabled:!0},r.a.createElement(y.t,{icon:"check",className:"pr-2"}),"Saved successfully"):r.a.createElement(y.e,{color:"primary",onClick:this.sendData},r.a.createElement(y.t,{icon:"save",className:"pr-2"}),"Save")),r.a.createElement(y.j,{md:"6",className:"text-right"},this.state.success&&r.a.createElement(v.b,{to:{pathname:"/create/"+this.state.uid}},r.a.createElement(y.e,{color:"green",outline:!0},r.a.createElement(y.t,{fa:!0,icon:"signature",className:"pr-2"}),"Create Beautyreport")),this.state.documentLink&&r.a.createElement(y.e,{color:"green",onClick:this.sendData,href:this.state.documentLink,tag:"a",target:"_blank"},r.a.createElement(y.t,{far:!0,icon:"file-excel",className:"pr-2"}),"Download Excel"))),r.a.createElement(y.A,{className:"mb-4"},r.a.createElement(y.j,{md:"8"},this.renderFields())),this.state.success?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.e,{color:"success",disabled:!0},r.a.createElement(y.t,{icon:"check",className:"pr-2"}),"Saved successfully"),r.a.createElement(v.b,{to:{pathname:"/create/"+this.state.uid}},r.a.createElement(y.e,{color:"green",outline:!0},r.a.createElement(y.t,{fa:!0,icon:"signature",className:"pr-2"}),"Create Beautyreport")),r.a.createElement(v.b,{to:{pathname:"/coach"}},r.a.createElement(y.e,{color:"red"},r.a.createElement(y.t,{icon:"angle-left",className:"pr-2"}),"Dashboard"))):r.a.createElement(y.e,{color:"primary",onClick:this.sendData},r.a.createElement(y.t,{icon:"save",className:"pr-2"}),"Save")):r.a.createElement("div",{className:"text-center"},r.a.createElement(y.G,null))):r.a.createElement(S.a,{to:"/login"})}}]),t}(r.a.Component),ee=Object(B.a)(J,{name:"update"})(Object(B.b)(X)),te=a(145),ae=a.n(te);a(530);function ne(){return(ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function re(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var le=r.a.createElement("defs",null,r.a.createElement("style",null,".cls-1{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:10px;}")),se=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("path",{className:"cls-1",d:"M174,451.47a228.62,228.62,0,0,1-7-56.24C167,269.17,269.17,167,395.23,167S623.49,269.17,623.49,395.23a228.6,228.6,0,0,1-7.67,58.88"}),r.a.createElement("line",{className:"cls-1",x1:395.23,y1:83.3,x2:395.23,y2:1.5}),r.a.createElement("line",{className:"cls-1",x1:174.66,y1:174.66,x2:116.82,y2:116.82}),r.a.createElement("line",{className:"cls-1",x1:615.8,y1:174.66,x2:673.65,y2:116.82}),r.a.createElement("line",{className:"cls-1",x1:707.17,y1:344.87,x2:788.97,y2:344.87}),r.a.createElement("line",{className:"cls-1",x1:1.5,y1:344.87,x2:83.3,y2:344.87}),r.a.createElement("path",{className:"cls-1",d:"M771.07,517c-139.5-57.13-202.42-77.72-375.84-80.41"}),r.a.createElement("path",{className:"cls-1",d:"M19.4,517c139.5-57.13,202.42-77.72,375.83-80.41"}))),ce=function(e){var t=e.svgRef,a=e.title,n=re(e,["svgRef","title"]);return r.a.createElement("svg",ne({viewBox:"0 0 790.47 518.46",ref:t},n),a?r.a.createElement("title",null,a):null,le,se)},oe=r.a.forwardRef((function(e,t){return r.a.createElement(ce,ne({svgRef:t},e))}));a.p;function ie(){return(ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ue(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var me=r.a.createElement("defs",null,r.a.createElement("style",null,".cls-1{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:10px;}")),de=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("circle",{className:"cls-1",cx:343.22,cy:343.22,r:198.1,transform:"translate(-142.17 343.22) rotate(-45)"}),r.a.createElement("line",{className:"cls-1",x1:343.22,y1:72.5,x2:343.22,y2:1.5}),r.a.createElement("line",{className:"cls-1",x1:343.22,y1:684.95,x2:343.22,y2:613.95}),r.a.createElement("line",{className:"cls-1",x1:151.79,y1:151.79,x2:101.59,y2:101.59}),r.a.createElement("line",{className:"cls-1",x1:584.86,y1:584.86,x2:534.66,y2:534.66}),r.a.createElement("line",{className:"cls-1",x1:534.66,y1:151.79,x2:584.86,y2:101.59}),r.a.createElement("line",{className:"cls-1",x1:101.59,y1:584.86,x2:151.79,y2:534.66}),r.a.createElement("line",{className:"cls-1",x1:613.95,y1:343.23,x2:684.95,y2:343.23}),r.a.createElement("line",{className:"cls-1",x1:1.5,y1:343.23,x2:72.5,y2:343.23}))),pe=function(e){var t=e.svgRef,a=e.title,n=ue(e,["svgRef","title"]);return r.a.createElement("svg",ie({viewBox:"0 0 686.45 686.45",ref:t},n),a?r.a.createElement("title",null,a):null,me,de)},he=r.a.forwardRef((function(e,t){return r.a.createElement(pe,ie({svgRef:t},e))}));a.p;function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ge(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var be=r.a.createElement("defs",null,r.a.createElement("style",null,".cls-1{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:10px;}")),Ee=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("path",{className:"cls-1",d:"M437.44,469.11A264.26,264.26,0,0,1,241,530.28C95.27,516.14-11.38,386.55,2.76,240.85c13-134.12,123.83-235.14,255-239.35"}),r.a.createElement("path",{className:"cls-1",d:"M437.44,469.11c-11.73.43-24.62.91-36.63-.25-145.7-14.14-252.36-143.73-238.22-289.44,7-72.19,43.57-134.84,95.17-177.92"}),r.a.createElement("polyline",{className:"cls-1",points:"416.91 47.22 381.18 75.98 339.78 64.72 356.97 104.61 330.3 143.13 376.5 139.18"}),r.a.createElement("polyline",{className:"cls-1",points:"416.91 47.22 419.89 93 456.19 115.88 415.18 130.19 404.83 175.88 376.5 139.18"}),r.a.createElement("polyline",{className:"cls-1",points:"377.57 310.15 359.77 285.49 368.67 258.46 341.65 268.46 317.07 249.45 318.08 280.19"}),r.a.createElement("polyline",{className:"cls-1",points:"377.57 310.15 347.15 310.53 330.74 333.77 322.69 306.11 292.78 297.67 318.08 280.19"}))),ve=function(e){var t=e.svgRef,a=e.title,n=ge(e,["svgRef","title"]);return r.a.createElement("svg",fe({viewBox:"0 0 457.69 533.04",ref:t},n),a?r.a.createElement("title",null,a):null,be,Ee)},ye=r.a.forwardRef((function(e,t){return r.a.createElement(ve,fe({svgRef:t},e))})),ke=(a.p,a(42)),Ne=a(59);function Se(){var e=Object(E.a)(["\n    mutation createUser ($token: String!, $urlPath: String!, $values: GenericScalar!) {\n        userUserFormPage(\n            token: $token,\n            url: $urlPath,\n            values: $values\n        ) {\n            result\n            errors {\n            name\n            errors\n            }\n        }\n    }\n"]);return Se=function(){return e},e}function xe(){var e=Object(E.a)(["\n    query ($token: String!) {\n        userAll(token: $token) {\n        id\n        telephone\n        email\n        firstName\n        lastName\n        address\n        dateJoined\n        city\n        country\n        postalCode\n        newsletter\n        isCustomer\n        userSet{\n            anamneseSet{\n            id\n            }\n            beautyreportSet{\n                id\n                }\n                id\n                customerId\n                firstName\n                lastName\n                email\n                telephone\n            }\n        }\n    }\n"]);return xe=function(){return e},e}function Oe(){var e=Object(E.a)(["\n    query ($token: String!) {\n        userSelf(token: $token) {\n            id\n            userSet{\n                anamneseSet{\n                    id\n                }\n                beautyreportSet{\n                    id\n                }\n                id\n                customerId\n                dateJoined\n                firstName\n                lastName\n                email\n                telephone\n            }\n        }\n    }\n"]);return Oe=function(){return e},e}var je=Object(ke.a)(Oe()),we=Object(ke.a)(xe()),_e=Object(ke.a)(Se()),Ce=new c.a({link:new i.a({uri:"https://manage.pharmaziegasse.at/api/graphql"}),cache:new u.a,defaultOptions:{query:{fetchPolicy:"network-only",errorPolicy:"all"}}}),Ie=new c.a({link:new i.a({uri:"https://manage.pharmaziegasse.at/api/graphql"}),cache:new u.a,defaultOptions:{query:{fetchPolicy:"cache-first",errorPolicy:"all"}}}),Te=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(l)))).state={},a.componentDidMount=function(){document.title="Your customers",a._loginUser(),a._fetchUsersFirstTime(),a.getGreetingImg(),a.getGreetingQuote()},a.syncManually=function(){a.setState({syncing:!0}),a._fetchUsersWithoutCache(),a._fetchNodeUsers(a.state.jwt)},a._fetchNodeUsers=function(e){var t={headers:{Authorization:"bearer "+e}};ae.a.get("https://charmnode.herokuapp.com/users",t).then((function(e){if(200===e.status){var t=e.data.customers;a._fetchAllUsers(t)}else 401===e.status||403===e.status?a._loginUser():a.setState({syncing:!1},(function(){return console.log("Error",e)}))})).catch((function(e){a.setState({syncing:!1},(function(){return console.log("Error",e)}))}))},a._loginUser=function(){a.state.syncing||a.setState({syncing:!0}),ae.a.post("https://charmnode.herokuapp.com/login",{username:"e5f8c11612736c5b10a9dfba00b9ec0e",password:"d127bf912c037358328d04ef6be30c4a"}).then((function(e){200===e.status?a.setState({jwt:e.data.token},(function(){return a._fetchNodeUsers(e.data.token)})):a.setState({syncing:!1},(function(){return console.log("Error",e)}))}),(function(e){a.setState({syncing:!1},(function(){return console.log("Error",e)}))}))},a._fetchUsersWithoutCache=function(){Ce.query({query:je,variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;console.log("Fetched data directly from server."),t.userSelf&&a.setState({coachusers:{userdata:t.userSelf}})})).catch((function(e){a.setState({syncing:!1},(function(){return console.log("Error",e)}))}))},a._fetchUsersFirstTime=function(){Ie.query({query:je,variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;console.log("Fetched data from cache."),t.userSelf&&a.setState({coachusers:{userdata:t.userSelf}},(function(){return a._fetchUsersWithoutCache()}))})).catch((function(e){a.setState({syncing:!1},(function(){return console.log("Error",e)}))}))},a._fetchAllUsers=function(e){Ce.query({query:we,variables:{token:localStorage.getItem("fprint")}}).then((function(t){var n=t.data.userAll;a._getDifference(n,e)})).catch((function(e){a.setState({syncing:!1},(function(){return console.log("Error",e)}))}))},a._getDifference=function(e,t){var n=t.map((function(t,a){return e.some((function(e){return e.telephone===t.phone}))?void 0:t}));(n=n.filter((function(e){return"undefined"!==typeof e}))).map((function(e,t){a._createUser(e)})),a.setState({syncing:void 0})},a._createUser=function(e){var t={title:void 0,coach_id:2,first_name:e.first_name,last_name:e.last_name,email:e.email?e.email:void 0,birthdate:void 0,telephone:e.phone?e.phone:void 0,address:e.default_address.address1?e.default_address.address1:void 0,city:e.default_address.city?e.default_address.city:void 0,postal_code:e.default_address.province_code?e.default_address.province_code:void 0,country:e.default_address.country_code?e.default_address.country_code:void 0,newsletter:!!e.accepts_marketing,verified:!!e.verified_email,customer_id:e.id};a.props.create({variables:{token:localStorage.getItem("fprint"),urlPath:"/internal/user-registration-page",values:t}}).then((function(e){var t=e.data;console.log(t),a._fetchUsersWithoutCache()})).catch((function(e){console.log("Error",e)}))},a.getGreetingImg=function(){var e=(new Date).getHours();e<11?a.setState({greetingImage:r.a.createElement(oe,{className:"img-fluid"})}):e<18?a.setState({greetingImage:r.a.createElement(he,{className:"img-fluid"})}):a.setState({greetingImage:r.a.createElement(ye,{className:"img-fluid"})})},a.getGreetingQuote=function(){var e=[{text:"Concentrate all your thoughts upon the work in hand. The sun's rays do not burn until brought \n                to a focus.",author:"Alexander Graham Bell"},{text:"Either you run the day or the day runs you.",author:"Jim Rohn"},{text:"When we strive to become better than we are, everything around us becomes better too.",author:"Paulo Coelho"},{text:"Opportunity is missed by most people because it is dressed in overalls and looks like work.",author:"Thomas Edison"},{text:"Just one small positive thought in the morning can change your whole day.",author:"Dalai Lama"},{text:"The future depends on what you do today.",author:"Mahatma Gandhi"}],t=Math.floor(Math.random()*(e.length-1));a.setState({greetingQuote:r.a.createElement("div",{className:"text-center"},r.a.createElement("small",null,r.a.createElement("q",null,e[t].text)),r.a.createElement("small",{className:"pl-2"},"\u2014",e[t].author))})},a.getGreetingTxt=function(){var e=(new Date).getHours();return e<11?r.a.createElement("span",null,"Guten Morgen"):e<18?r.a.createElement("span",null,"Willkommen zur\xfcck"):r.a.createElement("span",null,"Guten Abend")},a._getCoachUsers=function(){var e=a.state.coachusers;if(e&&e.userdata){var t=e.userdata.userSet;if(t.length>=1)return t.sort((function(e,t){return e.dateJoined<t.dateJoined?1:-1})),t.map((function(e,t){return{userid:e.customerId?e.customerId:"00000",first:e.firstName,last:e.lastName,email:r.a.createElement("a",{href:"mailto:"+e.email,className:"blue-text"},e.email),phone:e.telephone,actions:r.a.createElement("div",{className:"user-action"},e.beautyreportSet.length>=1?r.a.createElement(v.b,{to:{pathname:"/reports/"+e.id}},r.a.createElement(y.H,{placement:"top"},r.a.createElement(y.e,{rounded:!0,outline:!0,color:"green"},r.a.createElement(y.t,{icon:"signature",size:"lg"})),r.a.createElement("div",null,"Beautyreports einsehen"))):r.a.createElement(v.b,{to:{pathname:"/create/"+e.id}},r.a.createElement(y.H,{placement:"top"},r.a.createElement(y.e,{rounded:!0,outline:!0,color:"danger"},r.a.createElement(y.t,{icon:"signature",size:"lg"})),r.a.createElement("div",null,"Beautyreport erstellen"))),r.a.createElement(v.b,{to:{pathname:"/anamnesis/"+e.id}},e.anamneseSet.length>=1?r.a.createElement(y.H,{placement:"top"},r.a.createElement(y.e,{outline:!0,rounded:!0,color:"purple"},r.a.createElement(y.t,{icon:"file",size:"lg"})),r.a.createElement("div",null,"Anamnese erneuern")):r.a.createElement(y.H,{placement:"top"},r.a.createElement(y.e,{outline:!0,rounded:!0,color:"danger"},r.a.createElement(y.t,{far:!0,icon:"file",size:"lg"})),r.a.createElement("div",null,"Anamnese hinzuf\xfcgen"))),r.a.createElement(y.H,{placement:"top"},r.a.createElement(y.e,{href:"https://api.whatsapp.com/send?phone="+e.telephone.replace("+",""),target:"_blank",className:"btn-whatsapp-chat",outline:!0,rounded:!0,color:"success"},r.a.createElement(y.t,{fab:!0,icon:"whatsapp",size:"lg"})),r.a.createElement("div",null,"Mit ",e.firstName," chatten")))}}));console.log("No users for this coach")}},a._getTable=function(){return{columns:[{label:"Customer ID",field:"userid",sort:"asc"},{label:"First",field:"first",sort:"asc"},{label:"Last",field:"last",sort:"asc"},{label:"E-Mail",field:"email",sort:"disabled"},{label:"Phone",field:"phone",sort:"disabled"},{label:"Quick actions",field:"actions",sort:"disabled"}],rows:a._getCoachUsers()}},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.globalState;return e.logged?e.logged&&!e.coach?r.a.createElement(S.a,{to:"/dashboard"}):r.a.createElement("div",{id:"coach"},r.a.createElement("div",{className:"greeting py-5"},this.state.greetingImage,r.a.createElement("h2",{className:"text-center font-weight-bold"},this.getGreetingTxt(),", ",r.a.createElement("span",null,e.userdata.firstName),"!"),this.state.greetingQuote),r.a.createElement("div",{className:"mb-4 py-4 greeting-actions"},r.a.createElement(y.m,null,r.a.createElement(y.A,{className:"flex-center text-center"},r.a.createElement(y.j,{md:"6"},r.a.createElement("p",{className:"lead"},r.a.createElement(y.t,{icon:"bolt",className:"pr-2 orange-text"}),"Quick actions")),r.a.createElement(y.j,{md:"6"},r.a.createElement(y.e,{color:this.state.syncing?"cyan":!1===this.state.syncing?"danger":"blue",onClick:this.syncManually,disabled:!!this.state.syncing},this.state.syncing?r.a.createElement(y.t,{icon:"sync-alt fa-spin",className:"mr-2"}):r.a.createElement(r.a.Fragment,null,!1===this.state.syncing?r.a.createElement(y.t,{icon:"times-circle",className:"mr-2"}):r.a.createElement(y.t,{icon:"sync-alt",className:"pr-2"})),this.state.syncing?"Syncing":!1===this.state.syncing?"Try again":"Sync"),"s.santer@pharmaziegasse.at"===e.userdata.email&&r.a.createElement("a",{href:"https://manage.pharmaziegasse.at",rel:"noopener noreferrer",target:"_blank"},r.a.createElement(y.e,{color:"primary"},r.a.createElement(y.t,{icon:"dove",className:"pr-2"}),"Wagtail CMS")))))),r.a.createElement(y.m,null,r.a.createElement(y.A,{className:"text-center"},r.a.createElement(y.j,{md:"12"},r.a.createElement("h3",null,"Deine KundInnen"),r.a.createElement("div",{className:"table-labels"},r.a.createElement("span",null,r.a.createElement(y.t,{icon:"cube",className:"pr-1 pl-3 red-text"}),"Keine Daten vorhanden"),r.a.createElement("span",null,r.a.createElement(y.t,{icon:"cube",className:"pr-1 pl-3 purple-text"}),"Keine Aktion erforderlich"),r.a.createElement("span",null,r.a.createElement(y.t,{icon:"cube",className:"pr-1 pl-3 green-text"}),"Daten vorhanden")),r.a.createElement(y.n,{striped:!0,bordered:!0,small:!0,exportToCSV:!0,disableRetreatAfterSorting:!0,data:this._getTable(),paginationLabel:[r.a.createElement(y.t,{icon:"angle-left",size:"lg",className:"pl-3 pr-3"}),r.a.createElement(y.t,{icon:"angle-right",size:"lg",className:"pl-3 pr-3"})]})),r.a.createElement(y.j,{md:"6"}),r.a.createElement(y.j,{md:"6"})))):r.a.createElement(S.a,{to:"/login"})}}]),t}(r.a.Component),Ae=Ne(Object(B.a)(_e,{name:"create"}))(Object(B.b)(Te));function Pe(){var e=Object(E.a)(["\n    mutation sendbr (\n        $token: String!\n        $urlPath: String!\n        $values: GenericScalar!\n    ){\n        beautyreportBrFormPage(\n            token: $token\n            url: $urlPath\n            values: $values\n        ) {\n            result\n            errors {\n                errors\n                name\n            }\n        }\n    }\n"]);return Pe=function(){return e},e}function Be(){var e=Object(E.a)(["\n    query getlink($token: String!, $id: Int!) {\n        brLatestByUid(token: $token, uid: $id) {\n            __typename\n            id\n            document{\n                __typename\n                id\n                link\n            }\n        }\n    }\n"]);return Be=function(){return e},e}function Fe(){var e=Object(E.a)(["\n    query getAnamneseData_byUid($token: String!, $id: Int!) {\n        anLatestByUid(token: $token, uid: $id) {\n            id\n            date\n            formData\n            user {\n                id\n                username\n                firstName\n                lastName\n                anamneseSet{\n                    id\n                }\n            }\n        }\n    }\n"]);return Fe=function(){return e},e}function De(){var e=Object(E.a)(["\n    query getTemplate($token: String!) {\n        pages(token: $token) {\n            ... on ReportsReportsPage {\n                id\n                chapters{\n                    __typename\n                    ... on Reports_S_ChapterBlock{\n                        chapterHeader\n                        subChapters\n                    }\n                }\n            }\n        }\n        pages(token: $token) {\n            ... on BeautyreportBrFormPage {\n                urlPath\n                formFields {\n                    name\n                    fieldType        \n                }\n            }\n        }\n    }\n"]);return De=function(){return e},e}var Le=D()(De()),$e=D()(Fe()),Re=D()(Be()),qe=D()(Pe()),Ue=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).componentDidMount=function(){document.title="Generate Report",a.props.match&&a.props.match.params&&a.props.match.params.uid&&a.setState({uid:a.props.match.params.uid,loading:!0},(function(){return a.fetchData()}))},a.fetchTemplate=function(){a.props.client.query({query:Le,variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;if(void 0!==t.pages){var n=void 0,r=void 0;t.pages.map((function(e,a){return"ReportsReportsPage"===e.__typename&&(n=t.pages[a]),"BeautyreportBrFormPage"===e.__typename&&(r=t.pages[a].urlPath),!0})),a.setState({template:n,urlPath:r})}})).catch((function(e){console.error("Query error:",e)}))},a.fetchUserData=function(){return d.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.awrap(a.props.client.query({query:$e,variables:{token:localStorage.getItem("fprint"),id:a.state.uid}}).then((function(e){var t=e.data;console.log(t),console.log(t.anLatestByUid),void 0!==t.anLatestByUid&&t.anLatestByUid.user.anamneseSet.length>=1&&a.setState({user:t.anLatestByUid.user,userdata:t.anLatestByUid,hasReports:!0},(function(){return a.fetchTemplate()}))})).catch((function(e){"GraphQL error: User matching query does not exist."===e.message&&a.setState({exists:!1}),"GraphQL error: Anamnese matching query does not exist."===e.message&&a.setState({hasReports:!1}),console.error("Query error:",e)})));case 2:case"end":return e.stop()}}))},a.fetchData=function(){a.fetchUserData()},a._normalizeStatement=function(e,t){var n=a.state.userdata.formData;if(""!==e.trim()){var r=JSON.parse(n);return e.includes(", ")?!e.split(", ").map((function(e,t){return a._normalizeCondition(e,r)})).includes(!1):a._normalizeCondition(e,r)}return!0},a._getReturnValue=function(e,t){e.value&&(e=e.value),"string"==typeof e&&(e=e.replace(/\s/g,"_")),"object"==typeof e&&e.length>0&&(e=e[0].replace(/\s/g,"_"));var n=t.replace(/^\S+/g,e).replace(/"/g,"").split(" ");return null!==a.__convertType(n[0])&&void 0!==a.__convertType(n[0])&&a.__compare(a.__convertType(n[0]),n[1],n[2])},a._normalizeCondition=function(e,t){var n=e.match(/"(.*?)"/g);if(null!==n){var r=n[0].replace(/\s/g,"_");e=e.replace(/"(.*?)"/g,r)}var l=e.replace(/ .*/,"").toLowerCase();l=(l=(l=(l=l.replace(/\xe4/g,"a")).replace(/\xf6/g,"o")).replace(/\xfc/g,"u")).replace(/\xdf/g,"ss");var s=a.__convertType(t[l]);return void 0!==s&&(Array.isArray(s.value)?!!s.value.map((function(t,n){return a._getReturnValue(t,e)})).includes(!0):a._getReturnValue(s,e))},a.__convertType=function(e){try{return new Function("return "+e+";")()}catch(t){return e}},a.__compare=function(e,t,a){switch(t){case">":return e>parseInt(a);case"<":return e<parseInt(a);case">=":return e>=parseInt(a);case"<=":return e<=parseInt(a);case"==":return e==a;case"!=":return e!=a;case"===":return e===a;case"!==":return e!==a;default:return null}},a.getLink=function(){a.props.client.query({query:Re,variables:{token:localStorage.getItem("fprint"),id:a.state.uid}}).then((function(e){var t=e.data;t&&t.brLatestByUid&&a.setState({doclink:"https://manage.pharmaziegasse.at/"+t.brLatestByUid.document.link})})).catch((function(e){console.error("Query error:",e)}))},a.sendData=function(e){var t={uid:a.state.uid,data:JSON.stringify(e)};a.props.send({variables:{token:localStorage.getItem("fprint"),urlPath:a.state.urlPath,values:t}}).then((function(e){var t=e.data;"OK"===t.beautyreportBrFormPage.result?a.setState({loading:!1,error:void 0},(function(){return a.getLink()})):"FAIL"===t.beautyreportBrFormPage.result&&a.setState({loading:!1,error:t.beautyreportBrFormPage.errors})})).catch((function(e){console.log(e),a.setState({loading:!1,error:e})}))},a._fetchVariables=function(e){if(e.includes("{{")&&e.includes("}}")){var t=a.state.userdata.formData,n=JSON.parse(t);return e.match(/{{(.*?)}}/g).map((function(t,r){var l=t.replace(/{{|}}/g,"").toLowerCase();if(l=(l=(l=(l=l.replace(/\xe4/g,"a")).replace(/\xf6/g,"o")).replace(/\xfc/g,"u")).replace(/\xdf/g,"ss"),n[l])if(void 0!==n[l].value){var s=n[l].value,c=s;if(Array.isArray(s)){var o="";s.map((function(e,t){s.length>1?(o+=s[t],s.length-1!==t&&(o+=", ")):o+=s[t]})),c=o}e=e.replace(t,c)}else a.setState({version:!1,error:!0})})),e}return e},a.createReport=function(){var e=a.state.template,t=void 0;e.chapters.map((function(n,r){var l=a._fetchVariables(n.chapterHeader);t=t?Object(P.a)({},t,Object(_.a)({},"chapter"+r,Object(P.a)({},t["chapter"+r],{chapterHeader:l}))):Object(_.a)({},"chapter"+r,{chapterHeader:l}),n.subChapters.map((function(l,s){var c=a._fetchVariables(l.value.sub_chapter_header);t=Object(P.a)({},t,Object(_.a)({},"chapter"+r,Object(P.a)({},t["chapter"+r],Object(_.a)({},"subchapter"+s,Object(P.a)({},t["chapter"+r]["subchapter"+s],{subChapterHeader:c}))))),l.value.paragraphs.map((function(c,o){var i=c.value.statement,u=a._fetchVariables(c.value.paragraph);""!==i?a._normalizeStatement(i)&&(t=Object(P.a)({},t,Object(_.a)({},"chapter"+r,Object(P.a)({},t["chapter"+r],Object(_.a)({},"subchapter"+s,Object(P.a)({},t["chapter"+r]["subchapter"+s],Object(_.a)({},"paragraph"+o,Object(P.a)({},t["chapter"+r]["subchapter"+s]["paragraph"+o],{text:u})))))))):t=Object(P.a)({},t,Object(_.a)({},"chapter"+r,Object(P.a)({},t["chapter"+r],Object(_.a)({},"subchapter"+s,Object(P.a)({},t["chapter"+r]["subchapter"+s],Object(_.a)({},"paragraph"+o,Object(P.a)({},t["chapter"+r]["subchapter"+s]["paragraph"+o],{text:u})))))));r+1===e.chapters.length&&s+1===n.subChapters.length&&o+1===l.value.paragraphs.length&&a.sendData(t)}))}))}))},a.state={template:void 0,userdata:void 0,result:{},loading:!1,operations:0,userId:void 0,error:void 0,doclink:null,version:!0},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.globalState;return e.logged?e.logged&&!e.coach?r.a.createElement(S.a,{to:"/dashboard"}):(void 0!==this.state.template&&void 0!==this.state.userdata&&this.state.loading&&!this.state.error&&this.state.version&&this.createReport(),!1===this.state.exists?r.a.createElement(S.a,{to:"/coach"}):(console.log(this.state),r.a.createElement(y.m,{className:"text-center pt-5"},r.a.createElement("h2",{className:"text-center font-weight-bold"},"Create beauty report for ",this.state.user&&r.a.createElement(r.a.Fragment,null,this.state.user.firstName+" "+this.state.user.lastName)),r.a.createElement("div",{className:"mt-4"},r.a.createElement(y.A,null,r.a.createElement(y.j,{md:"12",className:"text-left"},r.a.createElement(v.b,{to:{pathname:"/coach"}},r.a.createElement(y.e,{color:"red"},r.a.createElement(y.t,{icon:"angle-left",className:"pr-2"}),"Dashboard")),r.a.createElement(v.b,{onClick:this.props.flushData,to:{pathname:"/reports/"+this.state.uid}},r.a.createElement(y.e,{color:"primary"},r.a.createElement(y.t,{icon:"list",className:"pr-2"}),"Report list"))))),r.a.createElement(y.A,{className:"flex-center mt-4"},r.a.createElement(y.j,{md:"6"},this.state.error?r.a.createElement(y.f,null,r.a.createElement(y.g,null,this.state.error&&this.state.error.length>=1?r.a.createElement(r.a.Fragment,null,this.state.error.map((function(e,t){return r.a.createElement(y.b,{key:t,color:"danger"},e.errors[0])}))):r.a.createElement(y.b,{color:"danger"},r.a.createElement("p",null,"Ein unerwarteter Fehler ist aufgetreten. Bitte kontaktieren Sie den Support der Werbeagentur Christian Aichner."),r.a.createElement("p",{className:"pt-3"},r.a.createElement("a",{href:"mailto:support@aichner-christian.com"},"support@aichner-christian.com"),r.a.createElement("br",null),"oder",r.a.createElement("br",null),"+43 681 20502754")))):r.a.createElement(y.f,null,this.state.uid&&this.state.hasReports&&this.state.version>=1?r.a.createElement(y.g,null,this.state.loading?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.z,{material:!0,preloader:!0}),r.a.createElement("p",{className:"lead"},"The beauty report is being created...")):r.a.createElement(r.a.Fragment,null,!1,r.a.createElement(y.b,{color:"success",className:"mb-4"},r.a.createElement("p",null,r.a.createElement(y.t,{icon:"check",className:"pr-2"}),"Beautyreport created and successfully saved.")),r.a.createElement("p",{className:"lead"},"Download as"),this.state.doclink?r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:this.state.doclink,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(y.e,{color:"primary"},r.a.createElement(y.t,{icon:"file-word",className:"pr-2"}),"Word"))):r.a.createElement(y.G,null))):r.a.createElement(y.g,null,r.a.createElement(y.b,{color:"info",className:"mb-0"},!1===this.state.version?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"lead"},"Die Anamnesedaten m\xfcssen neu gespeichert werden."),r.a.createElement("p",{className:"mb-3"},"Sie verwenden eine neue Version der Beautyreport Generierung. Da das Datenformat verbessert wurde, muss die Anamnese erneut gespeichert werden.",r.a.createElement("br",null),r.a.createElement("strong",null,"\xc4nderungen im Anamnesebogen sind nicht notwendig.")),r.a.createElement(v.b,{to:{pathname:"/anamnesis/"+this.state.uid}},r.a.createElement(y.e,{color:"info",size:"lg",rounded:!0},"Anamnesedaten neu speichern"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"lead"},"Es wurden keine Anamnesedaten gefunden!"),r.a.createElement("p",{className:"mb-3"},"M\xf6glicherwei\xdfe wurden die Daten des Anamnese-Gespr\xe4chs noch nicht in Charm \xfcbertragen."),r.a.createElement(v.b,{to:{pathname:"/anamnesis/"+this.state.uid}},r.a.createElement(y.e,{color:"info",size:"md",rounded:!0},"Anamnesedaten eintragen"))))))))))):r.a.createElement(S.a,{to:"/login"})}}]),t}(r.a.Component),ze=Ne(Object(B.a)(qe,{name:"send"}))(Object(B.b)(Ue));a(531);function Ge(){var e=Object(E.a)(['\n  mutation sendform($token: String!, $values: GenericScalar!) {\n      questionnaireQ3FormPage(\n          token: $token,\n          url: "/fragebogen-3",\n          values: $values) {\n          result\n          errors {\n              name\n              errors\n          }\n      }\n  }\n']);return Ge=function(){return e},e}function Me(){var e=Object(E.a)(["\n  query pages($token: String!) {\n      pages(token: $token) {\n          ... on QuestionnaireQ3FormPage {\n              id\n              urlPath\n              title\n              formFields {\n                  name\n                  fieldType\n                  helpText\n                  required\n                  choices\n                  defaultValue\n                  label\n              }\n          }\n      }\n  }\n"]);return Me=function(){return e},e}var Ve=D()(Me()),He=D()(Ge()),We=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).componentDidMount=function(){document.title="Custom Form",a.initialize()},a.initialize=function(){return d.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a.getAnamneseFields();case 1:case"end":return e.stop()}}))},a.resetButton=function(){a.state.success&&a.setState({success:!1})},a.getAnamneseFields=function(){a.props.client.query({query:Ve,variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;a.setState({data:t})})).catch((function(e){a.setState({data:!1},(function(){return console.error(e)}))}))},a.sendData=function(){var e;return d.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e={},a.state.data.pages.map((function(t,n){"QuestionnaireQ3FormPage"===t.__typename&&t.formFields.map((function(t,n){a.state[t.name]?e[t.name]=JSON.stringify({helpText:t.helpText,fieldType:t.fieldType,value:a.state[t.name]}):e[t.name]=void 0}))})),console.log(e),null===e||void 0===e||void 0===a.state.urlPath){t.next=6;break}return t.next=6,d.a.awrap(a.props.update({variables:{token:localStorage.getItem("fprint"),values:e,urlpath:a.state.urlPath}}).then((function(e){var t=e.data;if(console.log(t),t&&t.QuestionnaireQ3FormPage){var n=t.QuestionnaireQ3FormPage;"OK"===n.result?(console.log("Sent"),a.setState({success:!0,errors:[]}),[].forEach.call(document.querySelectorAll(".alert-error"),(function(e){e.parentNode.removeChild(e)}))):"FAIL"===n.result&&(console.log("Error"),a.setState({success:!1},(function(){return a.handleError(n.errors)})))}})).catch((function(e){console.error("Mutation error:",e)})));case 6:case"end":return t.stop()}}))},a.handleError=function(e){a.state.refNames.map((function(e,t){var n=a["".concat(e,"_ref")].current,r=n.querySelector(".alert");return null!==r&&n.removeChild(r),!0})),void 0!==e&&e.length>=1&&(a["".concat(e[0].name,"_ref")].current.scrollIntoView(),e.map((function(e,t){if("FormError"===e.__typename){var n=a["".concat(e.name,"_ref")].current,r=document.createElement("div");r.className="alert alert-danger alert-error mt-2",r.innerHTML='<i class="fa fa-angle-up pr-2"></i>'.concat(e.errors[0]),n.appendChild(r)}return!0})))},a._handleChange=function(e){a.setState(Object(_.a)({},e.target.name,e.target.value),(function(){return a.resetButton()}))},a._handleCheckBoxChange=function(e){a.setState(Object(_.a)({},e.target.name,e.target.checked),(function(){return a.resetButton()}))},a._handleCheckBoxesChange=function(e,t,n){var r=a.state[t];if(void 0!==r)if(r.includes(n)){var l=r.filter((function(e){return e!=n}));a.setState(Object(_.a)({},t,l),(function(){return a.resetButton()}))}else r.push(n),a.setState(Object(_.a)({},t,r),(function(){return a.resetButton()}));else{var s=[n];a.setState(Object(_.a)({},t,s),(function(){return a.resetButton()}))}},a._handleSelectChange=function(e){a.setState(Object(_.a)({},e.target.name,e.target.value),(function(){return a.resetButton()}))},a._setDefaultValue=function(e,t){if(""!==e.defaultValue&&void 0!==e.defaultValue&&(void 0===a.state[e.fieldType]||""===a.state[e.fieldType]||null===a.state[e.fieldType]))switch(e.fieldType){case"multiselect":var n=[];n=e.defaultValue.includes(", ")?e.defaultValue.split(", "):[e.defaultValue],a.state[e.name]||a.setState(Object(_.a)({},e.name,n));break;case"checkboxes":var r=[];r=e.defaultValue.includes(", ")?e.defaultValue.split(", "):[e.defaultValue],null!==a.state[e.name]&&void 0!==a.state[e.name]||a.setState(Object(_.a)({},e.name,r));break;case"checkbox":a.state[e.name]||(e.defaultValue?a.setState(Object(_.a)({},e.name,!0)):a.setState(Object(_.a)({},e.name,!1)));break;default:a.state[e.name]||a.setState(Object(_.a)({},e.name,e.defaultValue))}},a.getSelectValues=function(e){for(var t,a=[],n=e&&e.options,r=0,l=n.length;r<l;r++)(t=n[r]).selected&&a.push(t.value||t.text);return a},a._handleMultiSelectChange=function(e){a.setState(Object(_.a)({},e.target.name,a.getSelectValues(e.target)),(function(){return a.resetButton()}))},a._handleNumberClick=function(e,t){a.state[e]?a.setState(Object(_.a)({},e,parseInt(a.state[e],10)+parseInt(t,10)),(function(){return a.resetButton()})):a.setState(Object(_.a)({},e,0+parseInt(t,10)),(function(){return a.resetButton()}))},a.printCheckboxes=function(e,t){return e.choices.split(",").map((function(n,l){var s=n.trim().toLowerCase().replace(/ /g,""),c=n.trim();return r.a.createElement(y.v,{key:l,checked:!(!a.state[e.name]||!a.state[e.name].includes(c)),name:s,onChange:function(t){return a._handleCheckBoxesChange(t,e.name,c)},label:c,filled:!0,type:"checkbox",id:"fromGroupInput"+t+l})}))},a.printRadio=function(e,t,n,l){return e.split(",").map((function(e,s){var c=e.trim().toLowerCase().replace(/ /g,""),o=e.trim();return r.a.createElement(y.v,{onClick:function(){return a.setState(Object(_.a)({},t,o))},checked:!(!a.state[t]||a.state[t]!==o),label:o,key:s,name:c,type:"radio",id:"radio"+l+s,required:n})}))},a.printOptions=function(e,t){return e.split(",").map((function(e,t){var a=e.trim();return r.a.createElement("option",{key:t,value:a},a)}))},a.renderFields=function(){var e=a.state.data;if(void 0===e)return console.log("Loading"),r.a.createElement("div",{className:"text-center"},r.a.createElement(y.G,null));if(!1===e)return r.a.createElement("div",null,"Error!");if(void 0!==e){if(void 0!==e.pages){var t=void 0;if(e.pages.map((function(e,a){return"QuestionnaireQ3FormPage"===e.__typename&&(t=a),!0})),void 0!==t){void 0===a.state.urlPath&&a.setState({urlPath:e.pages[t].urlPath});var n=e.pages[t].formFields;return a.state.formtitle||a.setState({formtitle:e.pages[t].title}),n.map((function(e,t){switch(a["".concat(e.name,"_ref")]=r.a.createRef(),a.state.refNames.includes(e.name)||a.setState((function(t){return{refNames:[].concat(Object(z.a)(t.refNames),[e.name])}})),a._setDefaultValue(e,t),e.fieldType.toLowerCase()){case"singleline":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("input",{type:"text",value:a.state[e.name],onChange:a._handleChange,name:e.name,className:"form-control",id:"fromGroupInput"+t,required:e.required}));case"hidden":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group my-3 d-none"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("input",{type:"text",value:a.state[e.name],name:e.name,className:"form-control",id:"fromGroupInput"+t,disabled:!0}));case"number":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("div",{className:"\r def-number-input\r number-input\r mb-3"},r.a.createElement("button",{onClick:function(){return a._handleNumberClick(e.name,-1)},className:"minus"}),r.a.createElement("input",{name:e.name,id:"fromGroupInput"+t,value:a.state[e.name],onChange:a._handleChange,type:"number"}),r.a.createElement("button",{onClick:function(){return a._handleNumberClick(e.name,1)},className:"plus"})));case"checkbox":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement(y.v,{checked:a.state[e.name],name:e.name,onChange:a._handleCheckBoxChange,label:e.label&&e.label,filled:!0,type:"checkbox",id:"fromGroupInput"+t}));case"checkboxes":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement(y.r,null,a.printCheckboxes(e,t)));case"dropdown":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("div",null,r.a.createElement("select",{name:e.name,selected:a.state[e.name],onChange:a._handleSelectChange,className:"browser-default custom-select"},r.a.createElement("option",null,"Choose your option"),a.printOptions(e.choices,t))));case"multiselect":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("div",null,r.a.createElement("select",{multiple:!0,name:e.name,selected:a.state[e.name],onChange:a._handleMultiSelectChange,className:"browser-default custom-select"},r.a.createElement("option",null,"Choose your option"),a.printOptions(e.choices,t))));case"radio":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"my-3"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement(y.r,null,a.printRadio(e.choices,e.name,e.required,t)));case"multiline":return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("textarea",{className:"form-control",value:a.state[e.name],onChange:a._handleChange,name:e.name,id:"fromGroupInput"+t,rows:"5",required:e.required}));default:return r.a.createElement("div",{ref:a["".concat(e.name,"_ref")],key:t,className:"form-group"},r.a.createElement("label",{className:"heading",htmlFor:"fromGroupInput"+t},e.helpText&&e.helpText),r.a.createElement("input",{type:"text",value:a.state[e.name],onChange:a._handleChange,name:e.name,className:"form-control",id:"fromGroupInput"+t,required:e.required}))}}))}return null}return null}return null},a.state={urlPath:void 0,errors:[],refNames:[],data:void 0,user:void 0,success:!1},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.globalState;e.location;return t.logged?t.logged&&!t.coach?r.a.createElement(S.a,{to:"/dashboard"}):r.a.createElement(y.m,{id:"anamnesis",className:"text-left pt-5"},r.a.createElement("h2",{className:"mb-5 text-center"},this.state.formtitle),r.a.createElement("div",{className:"text-left mt-4"},r.a.createElement(v.b,{to:"/coach"},r.a.createElement(y.e,{color:"red"},r.a.createElement(y.t,{icon:"angle-left",className:"pr-2"}),"Zur\xfcck"))),r.a.createElement(y.A,{className:"mb-4"},r.a.createElement(y.j,{md:"8"},this.renderFields())),this.state.success?r.a.createElement(y.e,{color:"success",disabled:!0},r.a.createElement(y.t,{icon:"check",className:"pr-2"}),"Gespeichert"):r.a.createElement(y.e,{color:"secondary",onClick:this.sendData},r.a.createElement(y.t,{icon:"save",className:"pr-2"}),"Speichern")):r.a.createElement(S.a,{to:"/login"})}}]),t}(r.a.Component),Qe=Object(B.a)(He,{name:"update"})(Object(B.b)(We)),Ke=a(228),Je=a.n(Ke),Ye=(a(532),a(533),a(229)),Ze=a.n(Ye);function Xe(){var e=Object(E.a)(["\n  mutation passwordResetActivation($username: String!) {\n    passwordResetActivation(username: $username) {\n      result\n      message\n      msgCode\n    }\n  }\n"]);return Xe=function(){return e},e}function et(){var e=Object(E.a)(["\n  query(\n    $token: String!\n    $phone: String!\n  ) {\n    usernameByPhone(\n    token: $token,\n    phone: $phone\n    )\n  }\n"]);return et=function(){return e},e}function tt(){var e=Object(E.a)(["\n  query(\n    $token: String!\n    $email: String!\n  ) {\n    usernameByEmail(\n      token: $token,\n      email: $email\n    )\n  }\n"]);return tt=function(){return e},e}function at(){var e=Object(E.a)(["\n    mutation tokenAuth($username: String!, $password: String!){\n        tokenAuth(username: $username, password: $password) {\n            token\n        }\n    }\n"]);return at=function(){return e},e}var nt=Object(ke.a)(at()),rt=Object(ke.a)(tt()),lt=Object(ke.a)(et()),st=Object(ke.a)(Xe()),ct=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).componentWillMount=function(){document.title="Login";var e=localStorage.getItem("method");e&&a.setState({method:e})},a.handleChange=function(e){a.setState(Object(_.a)({},e.target.type,e.target.value))},a.handleSubmit=function(e){a.setState({loading:!0}),e.preventDefault(),e.target.className="needs-validation was-validated",a.state.method?a._getUsernameByMethod(a.state.method):a._getUsernameByMethod("email")},a._getUsernameByMethod=function(e){var t,n,r;return d.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return t={},n=void 0,r=localStorage.getItem("fprint"),"phone"===e?(t={token:r,phone:a.state.phone},n=lt):(t={token:r,email:a.state.email},n=rt),l.next=6,d.a.awrap(a.props.client.query({query:n,variables:t}).then((function(t){var n=t.data;console.log(n),"phone"===e?void 0!==n.usernameByPhone&&a._login(n.usernameByPhone):void 0!==n.usernameByEmail&&a._login(n.usernameByEmail)})).catch((function(e){a.setState({error:!0,loading:!1},(function(){return a.props.handler(!1)}))})));case 6:case"end":return l.stop()}}))},a._login=function(e){return d.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.awrap(a.props.mutate({variables:{username:e,password:a.state.password}}).then((function(e){e.loading;var t=e.data;void 0!==t&&void 0!==t.tokenAuth&&void 0!==t.tokenAuth.token&&(localStorage.setItem("fprint",t.tokenAuth.token),a.setState({error:!1},(function(){return a.props.handler(!0)})))})).catch((function(e,t){a.setState({error:!0,loading:!1},(function(){return a.props.handler(!1)}))})));case 2:case"end":return t.stop()}}))},a.handlePhoneChange=function(e){"phone"===a.state.method&&(e=e.replace(/\s/g,""),""===a.state.email?a.setState({phone:e.trim()}):a.setState({phone:e.trim(),email:""}))},a.handleEmailChange=function(e){"email"===a.state.method&&(""===a.state.phone?a.setState({email:e.target.value}):a.setState({email:e.target.value,phone:""}))},a.switchMethod=function(e){a.setState({method:e},(function(){return localStorage.setItem("method",e)}))},a.resetPsw=function(){var e=void 0,t={},n=localStorage.getItem("fprint");"phone"===a.state.method?(t={token:n,phone:a.state.phone},e=lt):(t={token:n,email:a.state.email},e=rt),a.props.client.query({query:e,variables:t}).then((function(e){var t=e.data;if(console.log(t),t){var n=t.usernameByEmail;a.props.reset({variables:{username:n}}).then((function(e){var t=e.data;t&&(t.passwordResetActivation.result?(console.log(t.passwordResetActivation.message),a.setState({successReset:"Eine E-Mail wurde an "+a.state.email+" gesendet.",errorReset:!1})):(console.log(t.passwordResetActivation.message),a.setState({successReset:!1,errorReset:"Eine E-Mail wurde bereits in den letzten 15 Minuten an "+a.state.email+" gesendet."})))})).catch((function(e){console.warn(e)}))}})).catch((function(e){console.warn(e)}))},a.state={email:"",phone:"",password:"",method:"email",error:!1},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return this.props.globalState.logged?r.a.createElement(S.a,{to:"/dashboard"}):r.a.createElement("div",{id:"login"},r.a.createElement(y.o,{color:"secondary-color lighten-3"}),r.a.createElement(y.s,null,r.a.createElement(y.A,null,r.a.createElement(y.j,{md:"10",className:"mx-auto float-none white z-depth-1 py-2 px-2"},r.a.createElement(y.g,null,r.a.createElement(y.A,{className:"flex-center"},this.state.loading?r.a.createElement(y.j,{md:"12",className:"py-5 text-center"},r.a.createElement(y.G,{big:!0})):r.a.createElement(y.j,{md:"6",className:"text-center"},this.state.error&&r.a.createElement(y.b,{color:"danger",className:"text-center"},"Die eingegebene Kombination existiert nicht."),r.a.createElement("img",{src:Ze.a,className:"img-fluid mb-4",alt:"Pharmaziegasse logo"}),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"needs-validation",noValidate:!0},r.a.createElement("p",{className:"h4 text-center mb-5"},"Dein individuelles Beauty Programm"),"email"===this.state.method?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"defaultFormLoginEmailEx",className:"grey-text"},"Deine E-Mail Adresse"),r.a.createElement("input",{type:"email",id:"defaultFormLoginEmailEx",className:"form-control",value:this.state.email,onChange:this.handleEmailChange,required:!0}),r.a.createElement("div",{className:"invalid-feedback"},"Bitte gib deine E-Mail Adresse an."),r.a.createElement("div",{className:"text-right"},r.a.createElement("span",{className:"blue-text",onClick:function(){return e.switchMethod("phone")}},"\xdcber Telefonnummer einloggen"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"pho"},"Telefon Nummer"),r.a.createElement(Je.a,{defaultCountry:"at",preferredCountries:["at","de","ch"],value:this.state.phone,onChange:this.handlePhoneChange,inputExtraProps:{className:"w-100"}}),r.a.createElement("div",{className:"text-right"},r.a.createElement("span",{className:"blue-text",onClick:function(){return e.switchMethod("email")}},"\xdcber E-Mail einloggen"))),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"defaultFormLoginPasswordEx",className:"grey-text"},"Dein Passwort"),r.a.createElement("input",{type:"password",id:"defaultFormLoginPasswordEx",className:"form-control",onChange:this.handleChange,required:!0}),r.a.createElement("div",{className:"invalid-feedback"},"Bitte gib ein Passwort an."),r.a.createElement("div",{className:"text-right"},r.a.createElement("span",{className:"blue-text",onClick:this.resetPsw},"Passwort vergessen?")),this.state.errorReset&&r.a.createElement(y.b,{color:"danger",className:"text-center"},r.a.createElement("p",null,this.state.errorReset)),this.state.successReset&&r.a.createElement(y.b,{color:"success",className:"text-center"},r.a.createElement("p",null,this.state.successReset)),r.a.createElement("div",{className:"text-center mt-4"},r.a.createElement(y.e,{color:"success",type:"submit"},r.a.createElement(y.t,{icon:"angle-right",className:"pr-2"}),"Einloggen")),r.a.createElement("p",{className:"text-muted text-center mt-3"},"Noch keinen Zugang? Jetzt einfach ",r.a.createElement("a",{href:"https://www.pharmaziegasse.at/?join"},r.a.createElement("strong",null,"ausprobieren")),"!")))))))))}}]),t}(r.a.Component),ot=Ne(Object(B.a)(nt),Object(B.a)(st,{name:"reset"}))(Object(B.b)(ct)),it=a(230),ut=a.n(it);function mt(){var e=Object(E.a)(["\n  query getuname($token: String!, $email: String!) {\n    usernameByEmail(token: $token, email: $email)\n  }\n"]);return mt=function(){return e},e}function dt(){var e=Object(E.a)(["\n  mutation setPassword($username: String!, $aToken: String!, $psw: String!) {\n    setPassword(\n      activationToken: $aToken,\n      password: $psw,\n      username: $username\n    ) {\n      result\n      message\n      msgCode\n    }\n  }\n"]);return dt=function(){return e},e}var pt=D()(dt()),ht=(D()(mt()),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).componentDidMount=function(){var e=ut.a.parse(a.props.location.search,{ignoreQueryPrefix:!0}),t=e.token,n=e.user;a.setState({activationToken:t,username:n})},a.submitForm=function(){a.state.password?a.state.passwordRepeat?a.state.password===a.state.passwordRepeat?a.state.accessToken&&a.state.username?a.props.set({variables:{atoken:a.state.accessToken,password:a.state.password,username:a.state.username}}).then((function(e){var t=e.data;console.log(t)})).catch((function(e){console.error("Mutation error:",e)})):a.setState({error:"Der Service ist derzeit nicht verf\xfcgbar. Bitte versuchen Sie es etwas sp\xe4ter."}):a.setState({error:"Ihre Passw\xf6rter sind abweichend. Bitte \xfcberpr\xfcfen Sie Ihre Eingabe."}):a.setState({error:"Bitte wiederholen Sie Ihr Passwort."}):a.setState({error:"Bitte geben Sie ein neues Passwort ein."})},a.handleChange=function(e){a.setState(Object(_.a)({},e.target.name,e.target.value))},a.state={password:"",passwordRepeat:"",error:!1,activationToken:!1,username:!1},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){this.props.globalState;return void 0===this.state.username||void 0===this.state.activationToken?r.a.createElement(S.a,{to:"/login"}):r.a.createElement(y.m,{className:"py-5"},r.a.createElement(y.A,{className:"flex-center"},r.a.createElement(y.j,{md:"6"},r.a.createElement(y.f,{className:"text-center"},r.a.createElement(y.g,null,r.a.createElement("h3",null,"Passwort setzen"),this.state.error&&r.a.createElement(y.b,{color:"danger"},r.a.createElement("p",null,this.state.error)),r.a.createElement(y.v,{type:"password",outline:!0,label:"Passwort",name:"password",value:this.state.password,onChange:this.handleChange}),r.a.createElement(y.v,{type:"password",outline:!0,label:"Passwort wiederholen",name:"passwordRepeat",value:this.state.passwordRepeat,onChange:this.handleChange}),r.a.createElement(y.e,{color:"secondary",onClick:this.submitForm},"Passwort setzen"))))))}}]),t}(r.a.Component)),ft=Object(B.a)(pt,{name:"set"})(Object(B.b)(ht)),gt=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).handleLogin=function(e){a.props.handler(e)},a.flushData=function(){a.props.flushData()},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(S.d,null,r.a.createElement(S.b,{exact:!0,path:"/dashboard",component:function(t){return r.a.createElement(w,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/login",component:function(t){return r.a.createElement(ot,Object.assign({handler:e.handleLogin,globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/anamnesis/:uid",component:function(t){return r.a.createElement(ee,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/coach",component:function(t){return r.a.createElement(Ae,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/reports/:uid",component:function(t){return r.a.createElement(U,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/create/:uid",component:function(t){return r.a.createElement(ze,Object.assign({globalState:e.props.globalState},t,{flushData:e.flushData}))}}),r.a.createElement(S.b,{exact:!0,path:"/edit/:uid",component:function(t){return r.a.createElement(A,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/reset",component:function(t){return r.a.createElement(ft,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/admin",component:function(){return window.location="https://manage.pharmaziegasse.at"}}),r.a.createElement(S.b,{exact:!0,path:"/form/:id",component:function(t){return r.a.createElement(Qe,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{exact:!0,path:"/api/graphiql",component:function(){return window.location="https://manage.pharmaziegasse.at/api/graphiql"}}),r.a.createElement(S.b,{exact:!0,path:"/test",component:function(t){return r.a.createElement(w,Object.assign({globalState:e.props.globalState},t))}}),r.a.createElement(S.b,{render:function(){return r.a.createElement(S.a,{to:"/login"})}}))}}]),t}(r.a.Component);function bt(){var e=Object(E.a)(["\n  query ($token: String!) {\n    userSelf(token: $token) {\n      id\n      lastLogin\n      email\n      isActive\n      isStaff\n      isCoach\n      isCustomer\n      title    \n      firstName\n      lastName\n      birthdate\n      telephone\n      address\n      city\n      postalCode\n      userSet{\n        anamneseSet{\n          id\n        }\n        beautyreportSet{\n          id\n        }\n        id\n        customerId\n        firstName\n        lastName\n        email\n        telephone\n      }\n      country\n      newsletter\n      verified\n    }\n  }\n"]);return bt=function(){return e},e}function Et(){var e=Object(E.a)(["\n  mutation refresh($token: String!) {\n    refreshToken(token: $token) {\n      payload\n      token\n    }\n  }\n"]);return Et=function(){return e},e}function vt(){var e=Object(E.a)(["\n  mutation verify($token: String!) {\n    verifyToken(token: $token) {\n      payload\n    }\n  }\n"]);return vt=function(){return e},e}function yt(){var e=Object(E.a)(["\n  mutation tokenAuth($username: String!, $password: String!){\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  }\n"]);return yt=function(){return e},e}var kt=Object(ke.a)(yt()),Nt=Object(ke.a)(vt()),St=Object(ke.a)(Et()),xt=Object(ke.a)(bt()),Ot=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={logged:!1,username:void 0,coach:void 0,loaded:!1,userdata:{},flush:!1},a.componentDidMount=function(){if(null!==localStorage.getItem("fprint"))try{a._verifyToken(),setInterval((function(){return d.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a._verifyToken();case 1:case"end":return e.stop()}}))}),18e4)}catch(e){console.log(e)}else a.setState({loaded:!0},(function(){return a._loginAnonymous()}))},a._getUserData=function(){a.props.client.query({query:xt,variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;void 0!==t.userSelf&&a.setState({userdata:t.userSelf,coach:t.userSelf.isCoach,loaded:!0})})).catch((function(e){console.log("Error",e)}))},a._loginAnonymous=function(){return d.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.awrap(a.props.login({variables:{username:"simon",password:"admin"}}).then((function(e){e.loading;var t=e.data;t&&t.tokenAuth&&t.tokenAuth.token&&localStorage.setItem("fprint",t.tokenAuth.token)})).catch((function(e,t){a.handler(!1)})));case 2:case"end":return e.stop()}}))},a._verifyToken=function(){a.props.verify({variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;t&&t.verifyToken?"simon"!==t.verifyToken.payload.username?a._isLogged(t.verifyToken.payload.exp,t.verifyToken.payload.origIat,t.verifyToken.payload.username):a.setState({logged:!1,username:void 0,loaded:!0}):a._notLogged()})).catch((function(e){console.error("Mutation error:",e)}))},a._notLogged=function(){a.setState({logged:!1,username:void 0,loaded:!0})},a._setLogged=function(e){a.setState({logged:!0,username:e},(function(){return a._getUserData()}))},a._isLogged=function(e,t,n){~~(Date.now()/1e3)>e?(console.log("Token has expired. User should be logged out."),a._notLogged()):(!0!==a.state.logged&&a.state.username!==n&&a._setLogged(n),a._refeshToken())},a._refeshToken=function(){a.props.refresh({variables:{token:localStorage.getItem("fprint")}}).then((function(e){var t=e.data;void 0!==t&&localStorage.setItem("fprint",t.refreshToken.token)})).catch((function(e){console.error("Mutation error:",e)}))},a.handler=function(e){e&&a._verifyToken()},a.flushData=function(){a.setState({flush:!a.state.flush})},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return console.log("Updated",this.state),r.a.createElement(v.a,null,r.a.createElement(O,null,r.a.createElement("div",{className:"flyout"},r.a.createElement("main",null,this.state.loaded&&r.a.createElement(gt,{handler:this.handler,globalState:this.state,flushData:this.flushData})),r.a.createElement(k,{globalState:this.state}))))}}]),t}(r.a.Component),jt=Ne(Object(B.a)(Nt,{name:"verify"}),Object(B.a)(St,{name:"refresh"}),Object(B.a)(kt,{name:"login"}))(Object(B.b)(Ot)),wt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _t(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a.d(t,"APIHost",(function(){return Ct}));var Ct="https://manage.pharmaziegasse.at",It=new u.b({introspectionQueryResultData:{__schema:{types:[]}}}),Tt=new u.a({fragmentMatcher:It}),At=Ct+"/api/graphql",Pt=new i.a({uri:At,headers:{authorization:localStorage.getItem("fprint")}}),Bt=new c.a({cache:Tt,link:Pt});s.a.render(r.a.createElement(o.b,{client:Bt},r.a.createElement(jt,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");wt?function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):_t(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):_t(e)}))}}()}},[[232,1,2]]]);
//# sourceMappingURL=main.364e76e8.chunk.js.map